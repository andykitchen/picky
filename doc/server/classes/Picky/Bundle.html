<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Picky::Bundle</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            Picky::Bundle 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/picky/bundle_rb.html">lib/picky/bundle.rb</a></li>
            
            <li><a href="../../files/lib/picky/bundle_indexed_rb.html">lib/picky/bundle_indexed.rb</a></li>
            
            <li><a href="../../files/lib/picky/bundle_indexing_rb.html">lib/picky/bundle_indexing.rb</a></li>
            
            <li><a href="../../files/lib/picky/bundle_realtime_rb.html">lib/picky/bundle_realtime.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>A <a href="Bundle.html">Bundle</a> is a number of indexes per [index,
category] combination.</p>

<p>At most, there are three indexes:</p>
<ul><li>
<p><strong>core</strong> index (always used)</p>
</li><li>
<p><strong>weights</strong> index (always used)</p>
</li><li>
<p><strong>similarity</strong> index (used with similarity)</p>
</li></ul>

<p>In <a href="../Picky.html">Picky</a>, indexing is separated from the index
handling itself through a parallel structure.</p>

<p>Both use methods provided by this base class, but have very different
goals:</p>
<ul><li>
<p><strong>Indexing</strong>::<strong><a
href="Bundle.html">Bundle</a></strong>::<strong>Base</strong> is just
concerned with creating index files / redis entries and providing helper
functions to e.g. check the indexes.</p>
</li><li>
<p><strong><a href="Index.html">Index</a></strong>::<strong><a
href="Bundle.html">Bundle</a></strong>::<strong>Base</strong> is concerned
with loading these index files into memory / redis and looking up search
data as fast as possible.</p>
</li></ul>

<p>An indexed bundle is a number of memory/redis indexes that compose the
indexes for a single category:</p>

<pre>* core (inverted) index
* weights index
* similarity index
* index configuration</pre>

<p>Indexed refers to them being indexed. This class notably offers the
methods:</p>

<pre>* load
* clear</pre>

<p>To (re)load or clear the current indexes.</p>

<p>A <a href="Bundle.html">Bundle</a> is a number of indexes per [index,
category] combination.</p>

<p>At most, there are three indexes:</p>
<ul><li>
<p><strong>core</strong> index (always used)</p>
</li><li>
<p><strong>weights</strong> index (always used)</p>
</li><li>
<p><strong>similarity</strong> index (used with similarity)</p>
</li></ul>

<p>In <a href="../Picky.html">Picky</a>, indexing is separated from the index
handling itself through a parallel structure.</p>

<p>Both use methods provided by this base class, but have very different
goals:</p>
<ul><li>
<p><strong>Indexing</strong>::<strong><a
href="Bundle.html">Bundle</a></strong> is just concerned with creating
index files and providing helper functions to e.g. check the indexes.</p>
</li><li>
<p><strong><a href="Index.html">Index</a></strong>::<strong><a
href="Bundle.html">Bundle</a></strong> is concerned with loading these
index files into memory and looking up search data as fast as possible.</p>
</li></ul>

<p>This is the indexing bundle.</p>

<p>It does all menial tasks that have nothing to do with the actual index
running etc. (Find these in Indexed::Bundle)</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>#</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-5B-5D">[]</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-add">add</a>,
              </li>
            
              
              <li>
                <a href="#method-i-add_partialized">add_partialized</a>,
              </li>
            
              
              <li>
                <a href="#method-i-add_similarity">add_similarity</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-backend">backend</a>,
              </li>
            
              
              <li>
                <a href="#method-i-build_realtime">build_realtime</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-clear">clear</a>,
              </li>
            
              
              <li>
                <a href="#method-i-clear_configuration">clear_configuration</a>,
              </li>
            
              
              <li>
                <a href="#method-i-clear_inverted">clear_inverted</a>,
              </li>
            
              
              <li>
                <a href="#method-i-clear_realtime">clear_realtime</a>,
              </li>
            
              
              <li>
                <a href="#method-i-clear_similarity">clear_similarity</a>,
              </li>
            
              
              <li>
                <a href="#method-i-clear_weights">clear_weights</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-delete">delete</a>,
              </li>
            
              
              <li>
                <a href="#method-i-dump">dump</a>,
              </li>
            
              
              <li>
                <a href="#method-i-dump_configuration">dump_configuration</a>,
              </li>
            
              
              <li>
                <a href="#method-i-dump_inverted">dump_inverted</a>,
              </li>
            
              
              <li>
                <a href="#method-i-dump_realtime">dump_realtime</a>,
              </li>
            
              
              <li>
                <a href="#method-i-dump_similarity">dump_similarity</a>,
              </li>
            
              
              <li>
                <a href="#method-i-dump_weights">dump_weights</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-empty">empty</a>,
              </li>
            
              
              <li>
                <a href="#method-i-empty_configuration">empty_configuration</a>,
              </li>
            
              
              <li>
                <a href="#method-i-empty_inverted">empty_inverted</a>,
              </li>
            
              
              <li>
                <a href="#method-i-empty_realtime">empty_realtime</a>,
              </li>
            
              
              <li>
                <a href="#method-i-empty_similarity">empty_similarity</a>,
              </li>
            
              
              <li>
                <a href="#method-i-empty_weights">empty_weights</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-identifier">identifier</a>,
              </li>
            
              
              <li>
                <a href="#method-i-ids">ids</a>,
              </li>
            
              
              <li>
                <a href="#method-i-index_path">index_path</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>K</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-key_format">key_format</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-load">load</a>,
              </li>
            
              
              <li>
                <a href="#method-i-load_configuration">load_configuration</a>,
              </li>
            
              
              <li>
                <a href="#method-i-load_inverted">load_inverted</a>,
              </li>
            
              
              <li>
                <a href="#method-i-load_realtime">load_realtime</a>,
              </li>
            
              
              <li>
                <a href="#method-i-load_similarity">load_similarity</a>,
              </li>
            
              
              <li>
                <a href="#method-i-load_weights">load_weights</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-remove">remove</a>,
              </li>
            
              
              <li>
                <a href="#method-i-reset_backend">reset_backend</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-similar">similar</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-to_s">to_s</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>W</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-weight">weight</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>backend_configuration</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>backend_inverted</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>backend_similarity</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>backend_weights</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>category</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>configuration</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>inverted</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>name</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>partial_strategy</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>realtime</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>similarity</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>similarity_strategy</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>weights</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>weights_strategy</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <a name="method-c-new"></a><b>new</b>(name, category, weights_strategy, partial_strategy, similarity_strategy, options = {})
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 46</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span> <span class="ruby-identifier">name</span>, <span class="ruby-identifier">category</span>, <span class="ruby-identifier">weights_strategy</span>, <span class="ruby-identifier">partial_strategy</span>, <span class="ruby-identifier">similarity_strategy</span>, <span class="ruby-identifier">options</span> = {}
  <span class="ruby-ivar">@name</span>     = <span class="ruby-identifier">name</span>
  <span class="ruby-ivar">@category</span> = <span class="ruby-identifier">category</span>

  <span class="ruby-comment"># TODO Tidy up a bit.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-ivar">@key_format</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span> <span class="ruby-value">:key_format</span>
  <span class="ruby-ivar">@backend</span>    = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span> <span class="ruby-value">:backend</span>

  <span class="ruby-ivar">@weights_strategy</span>    = <span class="ruby-identifier">weights_strategy</span>
  <span class="ruby-ivar">@partial_strategy</span>    = <span class="ruby-identifier">partial_strategy</span>
  <span class="ruby-ivar">@similarity_strategy</span> = <span class="ruby-identifier">similarity_strategy</span>

  <span class="ruby-identifier">reset_backend</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-5B-5D">
            
              <a name="method-i-5B-5D"></a><b>[]</b>(sym_or_string)
            
          </div>
          
          
            <div class="description">
              <p>Get settings for this bundle.</p>

<p>Returns an object.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-5B-5D_source')" id="l_method-i-5B-5D_source">show</a>
                
              </p>
              <div id="method-i-5B-5D_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 42</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">[]</span> <span class="ruby-keyword ruby-title">sym_or_string</span>
  <span class="ruby-ivar">@configuration</span>[<span class="ruby-identifier">sym_or_string</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-add">
            
              <a name="method-i-add"></a><b>add</b>(id, str_or_sym, where = :unshift)
            
          </div>
          
          
            <div class="description">
              <p>Returns a reference to the array where the id has been added.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-add_source')" id="l_method-i-add_source">show</a>
                
              </p>
              <div id="method-i-add_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_realtime.rb, line 33</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">add</span> <span class="ruby-identifier">id</span>, <span class="ruby-identifier">str_or_sym</span>, <span class="ruby-identifier">where</span> = <span class="ruby-value">:unshift</span>
  <span class="ruby-identifier">str_or_syms</span> = <span class="ruby-ivar">@realtime</span>[<span class="ruby-identifier">id</span>] <span class="ruby-operator">||</span> (<span class="ruby-ivar">@realtime</span>[<span class="ruby-identifier">id</span>] = [])

  <span class="ruby-comment"># Inverted.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">ids</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">str_or_syms</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">str_or_sym</span>
    <span class="ruby-identifier">ids</span> = <span class="ruby-ivar">@inverted</span>[<span class="ruby-identifier">str_or_sym</span>]
    <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">id</span>
    <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">send</span> <span class="ruby-identifier">where</span>, <span class="ruby-identifier">id</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Update the realtime index.</span>
    <span class="ruby-comment">#</span>
    <span class="ruby-identifier">str_or_syms</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">str_or_sym</span>

    <span class="ruby-comment"># TODO Introduce a new method?</span>
    <span class="ruby-comment">#</span>
    <span class="ruby-identifier">ids</span> = <span class="ruby-ivar">@inverted</span>[<span class="ruby-identifier">str_or_sym</span>] <span class="ruby-operator">||</span> (<span class="ruby-ivar">@inverted</span>[<span class="ruby-identifier">str_or_sym</span>] = []) <span class="ruby-comment"># Ensures that we get an extended Array</span>
    <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">send</span> <span class="ruby-identifier">where</span>, <span class="ruby-identifier">id</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Weights.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-ivar">@weights</span>[<span class="ruby-identifier">str_or_sym</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">weights_strategy</span>.<span class="ruby-identifier">weight_for</span> <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">size</span>

  <span class="ruby-comment"># Similarity.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">add_similarity</span> <span class="ruby-identifier">str_or_sym</span>, <span class="ruby-identifier">where</span>

  <span class="ruby-comment"># Return reference.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">ids</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-add_partialized">
            
              <a name="method-i-add_partialized"></a><b>add_partialized</b>(id, text, where = :unshift)
            
          </div>
          
          
            <div class="description">
              <p>Partializes the text and then adds each.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-add_partialized_source')" id="l_method-i-add_partialized_source">show</a>
                
              </p>
              <div id="method-i-add_partialized_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_realtime.rb, line 83</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">add_partialized</span> <span class="ruby-identifier">id</span>, <span class="ruby-identifier">text</span>, <span class="ruby-identifier">where</span> = <span class="ruby-value">:unshift</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">partial_strategy</span>.<span class="ruby-identifier">each_partial</span> <span class="ruby-identifier">text</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">partial_text</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">add</span> <span class="ruby-identifier">id</span>, <span class="ruby-identifier">partial_text</span>, <span class="ruby-identifier">where</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-add_similarity">
            
              <a name="method-i-add_similarity"></a><b>add_similarity</b>(str_or_sym, where = :unshift)
            
          </div>
          
          
            <div class="description">
              <p>Add string/symbol to similarity index.</p>

<p>TODO Probably where makes no sense here. Should have its own order.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-add_similarity_source')" id="l_method-i-add_similarity_source">show</a>
                
              </p>
              <div id="method-i-add_similarity_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_realtime.rb, line 70</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">add_similarity</span> <span class="ruby-identifier">str_or_sym</span>, <span class="ruby-identifier">where</span> = <span class="ruby-value">:unshift</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">encoded</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">similarity_strategy</span>.<span class="ruby-identifier">encoded</span>(<span class="ruby-identifier">str_or_sym</span>)
    <span class="ruby-identifier">similarity</span> = <span class="ruby-ivar">@similarity</span>[<span class="ruby-identifier">encoded</span>] <span class="ruby-operator">||</span> (<span class="ruby-ivar">@similarity</span>[<span class="ruby-identifier">encoded</span>] = []) <span class="ruby-comment"># Ensures that we get an extended Array</span>

    <span class="ruby-comment"># Not completely correct, as others will also be affected, but meh.</span>
    <span class="ruby-comment">#</span>
    <span class="ruby-identifier">similarity</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">str_or_sym</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">similarity</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">str_or_sym</span>
    <span class="ruby-identifier">similarity</span>.<span class="ruby-identifier">send</span> <span class="ruby-identifier">where</span>, <span class="ruby-identifier">str_or_sym</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-backend">
            
              <a name="method-i-backend"></a><b>backend</b>()
            
          </div>
          
          
            <div class="description">
              <p>If no specific backend has been set, uses the category’s backend.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-backend_source')" id="l_method-i-backend_source">show</a>
                
              </p>
              <div id="method-i-backend_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 68</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">backend</span>
  <span class="ruby-ivar">@backend</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">category</span>.<span class="ruby-identifier">backend</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-build_realtime">
            
              <a name="method-i-build_realtime"></a><b>build_realtime</b>()
            
          </div>
          
          
            <div class="description">
              <p>Builds the realtime mapping.</p>

<p>Note: Experimental feature.</p>

<p>TODO Subset of <a href="Bundle.html#method-i-add">#add</a>. Rewrite.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-build_realtime_source')" id="l_method-i-build_realtime_source">show</a>
                
              </p>
              <div id="method-i-build_realtime_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_realtime.rb, line 95</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">build_realtime</span>
  <span class="ruby-identifier">clear_realtime</span>
  <span class="ruby-ivar">@inverted</span>.<span class="ruby-identifier">each_pair</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">str_or_sym</span>, <span class="ruby-identifier">ids</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">str_or_syms</span> = <span class="ruby-ivar">@realtime</span>[<span class="ruby-identifier">id</span>]
      <span class="ruby-identifier">str_or_syms</span> = (<span class="ruby-ivar">@realtime</span>[<span class="ruby-identifier">id</span>] = []) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">str_or_syms</span> <span class="ruby-comment"># TODO Nicefy.</span>
      <span class="ruby-ivar">@realtime</span>[<span class="ruby-identifier">id</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">str_or_sym</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">str_or_syms</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">str_or_sym</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-clear">
            
              <a name="method-i-clear"></a><b>clear</b>()
            
          </div>
          
          
            <div class="description">
              <p>Clears all indexes.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-clear_source')" id="l_method-i-clear_source">show</a>
                
              </p>
              <div id="method-i-clear_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 89</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">clear</span>
  <span class="ruby-identifier">clear_inverted</span>
  <span class="ruby-identifier">clear_weights</span>
  <span class="ruby-identifier">clear_similarity</span>
  <span class="ruby-identifier">clear_configuration</span>
  <span class="ruby-identifier">clear_realtime</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-clear_configuration">
            
              <a name="method-i-clear_configuration"></a><b>clear_configuration</b>()
            
          </div>
          
          
            <div class="description">
              <p>Clears the configuration.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-clear_configuration_source')" id="l_method-i-clear_configuration_source">show</a>
                
              </p>
              <div id="method-i-clear_configuration_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 114</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">clear_configuration</span>
  <span class="ruby-identifier">configuration</span>.<span class="ruby-identifier">clear</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-clear_inverted">
            
              <a name="method-i-clear_inverted"></a><b>clear_inverted</b>()
            
          </div>
          
          
            <div class="description">
              <p>Clears the core index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-clear_inverted_source')" id="l_method-i-clear_inverted_source">show</a>
                
              </p>
              <div id="method-i-clear_inverted_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">clear_inverted</span>
  <span class="ruby-identifier">inverted</span>.<span class="ruby-identifier">clear</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-clear_realtime">
            
              <a name="method-i-clear_realtime"></a><b>clear_realtime</b>()
            
          </div>
          
          
            <div class="description">
              <p>Clears the realtime mapping.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-clear_realtime_source')" id="l_method-i-clear_realtime_source">show</a>
                
              </p>
              <div id="method-i-clear_realtime_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 119</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">clear_realtime</span>
  <span class="ruby-identifier">realtime</span>.<span class="ruby-identifier">clear</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-clear_similarity">
            
              <a name="method-i-clear_similarity"></a><b>clear_similarity</b>()
            
          </div>
          
          
            <div class="description">
              <p>Clears the similarity index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-clear_similarity_source')" id="l_method-i-clear_similarity_source">show</a>
                
              </p>
              <div id="method-i-clear_similarity_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 109</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">clear_similarity</span>
  <span class="ruby-identifier">similarity</span>.<span class="ruby-identifier">clear</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-clear_weights">
            
              <a name="method-i-clear_weights"></a><b>clear_weights</b>()
            
          </div>
          
          
            <div class="description">
              <p>Clears the weights index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-clear_weights_source')" id="l_method-i-clear_weights_source">show</a>
                
              </p>
              <div id="method-i-clear_weights_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 104</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">clear_weights</span>
  <span class="ruby-identifier">weights</span>.<span class="ruby-identifier">clear</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-delete">
            
              <a name="method-i-delete"></a><b>delete</b>()
            
          </div>
          
          
            <div class="description">
              <p>Delete all index files.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-delete_source')" id="l_method-i-delete_source">show</a>
                
              </p>
              <div id="method-i-delete_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 160</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">delete</span>
  <span class="ruby-ivar">@backend_inverted</span>.<span class="ruby-identifier">delete</span>       <span class="ruby-keyword">if</span> <span class="ruby-ivar">@backend_inverted</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:delete</span>
  <span class="ruby-comment"># TODO THINK about this. Perhaps the strategies should implement the backend methods?</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-ivar">@backend_weights</span>.<span class="ruby-identifier">delete</span>        <span class="ruby-keyword">if</span> <span class="ruby-ivar">@backend_weights</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:delete</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@weights_strategy</span>.<span class="ruby-identifier">saved?</span>
  <span class="ruby-ivar">@backend_similarity</span>.<span class="ruby-identifier">delete</span>     <span class="ruby-keyword">if</span> <span class="ruby-ivar">@backend_similarity</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:delete</span>
  <span class="ruby-ivar">@backend_configuration</span>.<span class="ruby-identifier">delete</span>  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@backend_configuration</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:delete</span>
  <span class="ruby-ivar">@backend_realtime</span>.<span class="ruby-identifier">delete</span>  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@backend_realtime</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:delete</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-dump">
            
              <a name="method-i-dump"></a><b>dump</b>()
            
          </div>
          
          
            <div class="description">
              <p>Saves the indexes in a dump file.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-dump_source')" id="l_method-i-dump_source">show</a>
                
              </p>
              <div id="method-i-dump_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexing.rb, line 33</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">dump</span>
  <span class="ruby-identifier">dump_inverted</span>
  <span class="ruby-identifier">dump_similarity</span>
  <span class="ruby-identifier">dump_weights</span>
  <span class="ruby-identifier">dump_configuration</span>
  <span class="ruby-identifier">dump_realtime</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-dump_configuration">
            
              <a name="method-i-dump_configuration"></a><b>dump_configuration</b>()
            
          </div>
          
          
            <div class="description">
              <p>Dumps the configuration.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-dump_configuration_source')" id="l_method-i-dump_configuration_source">show</a>
                
              </p>
              <div id="method-i-dump_configuration_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexing.rb, line 59</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">dump_configuration</span>
  <span class="ruby-ivar">@backend_configuration</span>.<span class="ruby-identifier">dump</span> <span class="ruby-ivar">@configuration</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-dump_inverted">
            
              <a name="method-i-dump_inverted"></a><b>dump_inverted</b>()
            
          </div>
          
          
            <div class="description">
              <p>Dumps the core index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-dump_inverted_source')" id="l_method-i-dump_inverted_source">show</a>
                
              </p>
              <div id="method-i-dump_inverted_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexing.rb, line 42</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">dump_inverted</span>
  <span class="ruby-ivar">@backend_inverted</span>.<span class="ruby-identifier">dump</span> <span class="ruby-ivar">@inverted</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-dump_realtime">
            
              <a name="method-i-dump_realtime"></a><b>dump_realtime</b>()
            
          </div>
          
          
            <div class="description">
              <p>Dumps the realtime.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-dump_realtime_source')" id="l_method-i-dump_realtime_source">show</a>
                
              </p>
              <div id="method-i-dump_realtime_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexing.rb, line 64</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">dump_realtime</span>
  <span class="ruby-ivar">@backend_realtime</span>.<span class="ruby-identifier">dump</span> <span class="ruby-ivar">@realtime</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-dump_similarity">
            
              <a name="method-i-dump_similarity"></a><b>dump_similarity</b>()
            
          </div>
          
          
            <div class="description">
              <p>Dumps the similarity index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-dump_similarity_source')" id="l_method-i-dump_similarity_source">show</a>
                
              </p>
              <div id="method-i-dump_similarity_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexing.rb, line 54</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">dump_similarity</span>
  <span class="ruby-ivar">@backend_similarity</span>.<span class="ruby-identifier">dump</span> <span class="ruby-ivar">@similarity</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@similarity_strategy</span>.<span class="ruby-identifier">saved?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-dump_weights">
            
              <a name="method-i-dump_weights"></a><b>dump_weights</b>()
            
          </div>
          
          
            <div class="description">
              <p>Dumps the weights index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-dump_weights_source')" id="l_method-i-dump_weights_source">show</a>
                
              </p>
              <div id="method-i-dump_weights_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexing.rb, line 47</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">dump_weights</span>
  <span class="ruby-comment"># TODO THINK about this. Perhaps the strategies should implement the backend methods? Or only the internal index ones?</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-ivar">@backend_weights</span>.<span class="ruby-identifier">dump</span> <span class="ruby-ivar">@weights</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@weights_strategy</span>.<span class="ruby-identifier">saved?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-empty">
            
              <a name="method-i-empty"></a><b>empty</b>()
            
          </div>
          
          
            <div class="description">
              <p>“Empties” the index(es) by getting a new empty internal backend instance.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-empty_source')" id="l_method-i-empty_source">show</a>
                
              </p>
              <div id="method-i-empty_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 98</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">empty</span>
  <span class="ruby-identifier">empty_inverted</span>
  <span class="ruby-identifier">empty_weights</span>
  <span class="ruby-identifier">empty_similarity</span>
  <span class="ruby-identifier">empty_configuration</span>
  <span class="ruby-identifier">empty_realtime</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-empty_configuration">
            
              <a name="method-i-empty_configuration"></a><b>empty_configuration</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-empty_configuration_source')" id="l_method-i-empty_configuration_source">show</a>
                
              </p>
              <div id="method-i-empty_configuration_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 116</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">empty_configuration</span>
  <span class="ruby-ivar">@configuration</span> = <span class="ruby-ivar">@backend_configuration</span>.<span class="ruby-identifier">empty</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-empty_inverted">
            
              <a name="method-i-empty_inverted"></a><b>empty_inverted</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-empty_inverted_source')" id="l_method-i-empty_inverted_source">show</a>
                
              </p>
              <div id="method-i-empty_inverted_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 105</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">empty_inverted</span>
  <span class="ruby-ivar">@inverted</span> = <span class="ruby-ivar">@backend_inverted</span>.<span class="ruby-identifier">empty</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-empty_realtime">
            
              <a name="method-i-empty_realtime"></a><b>empty_realtime</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-empty_realtime_source')" id="l_method-i-empty_realtime_source">show</a>
                
              </p>
              <div id="method-i-empty_realtime_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 119</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">empty_realtime</span>
  <span class="ruby-ivar">@realtime</span> = <span class="ruby-ivar">@backend_realtime</span>.<span class="ruby-identifier">empty</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-empty_similarity">
            
              <a name="method-i-empty_similarity"></a><b>empty_similarity</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-empty_similarity_source')" id="l_method-i-empty_similarity_source">show</a>
                
              </p>
              <div id="method-i-empty_similarity_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 113</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">empty_similarity</span>
  <span class="ruby-ivar">@similarity</span> = <span class="ruby-ivar">@backend_similarity</span>.<span class="ruby-identifier">empty</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-empty_weights">
            
              <a name="method-i-empty_weights"></a><b>empty_weights</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-empty_weights_source')" id="l_method-i-empty_weights_source">show</a>
                
              </p>
              <div id="method-i-empty_weights_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 108</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">empty_weights</span>
  <span class="ruby-comment"># TODO THINK about this. Perhaps the strategies should implement the backend methods?</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-ivar">@weights</span> = <span class="ruby-ivar">@weights_strategy</span>.<span class="ruby-identifier">saved?</span><span class="ruby-operator">?</span> <span class="ruby-ivar">@backend_weights</span>.<span class="ruby-identifier">empty</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@weights_strategy</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identifier">
            
              <a name="method-i-identifier"></a><b>identifier</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identifier_source')" id="l_method-i-identifier_source">show</a>
                
              </p>
              <div id="method-i-identifier_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 61</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identifier</span>
  <span class="ruby-node">&quot;#{category.identifier}:#{name}&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ids">
            
              <a name="method-i-ids"></a><b>ids</b>(sym_or_string)
            
          </div>
          
          
            <div class="description">
              <p>Get the ids for the given symbol.</p>

<p>Returns a (potentially empty) array of ids.</p>

<p>TODO Empty string ok, or does it need to be from the backend?</p>

<pre>Should the backend always return an empty array? (Probably no)</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ids_source')" id="l_method-i-ids_source">show</a>
                
              </p>
              <div id="method-i-ids_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 26</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ids</span> <span class="ruby-identifier">sym_or_string</span>
  <span class="ruby-ivar">@inverted</span>[<span class="ruby-identifier">sym_or_string</span>] <span class="ruby-operator">||</span> []
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-index_path">
            
              <a name="method-i-index_path"></a><b>index_path</b>(type = nil)
            
          </div>
          
          
            <div class="description">
              <p>Path and partial filename of a specific subindex.</p>

<p>Subindexes are:</p>

<pre>* inverted index
* weights index
* partial index
* similarity index</pre>

<p>Returns just the part without subindex type, if none given.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-index_path_source')" id="l_method-i-index_path_source">show</a>
                
              </p>
              <div id="method-i-index_path_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 154</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">index_path</span> <span class="ruby-identifier">type</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span> <span class="ruby-identifier">index_directory</span>, <span class="ruby-node">&quot;#{category.name}_#{name}#{ &quot;_#{type}&quot; if type }&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-key_format">
            
              <a name="method-i-key_format"></a><b>key_format</b>()
            
          </div>
          
          
            <div class="description">
              <p>If a key format is set, use it, else delegate to the category.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-key_format_source')" id="l_method-i-key_format_source">show</a>
                
              </p>
              <div id="method-i-key_format_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 139</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">key_format</span>
  <span class="ruby-ivar">@key_format</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@category</span>.<span class="ruby-identifier">key_format</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-load">
            
              <a name="method-i-load"></a><b>load</b>()
            
          </div>
          
          
            <div class="description">
              <p>Loads all indexes.</p>

<p>Loading loads index objects from the backend. They should each respond to
[] and return something appropriate.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-load_source')" id="l_method-i-load_source">show</a>
                
              </p>
              <div id="method-i-load_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 51</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">load</span>
  <span class="ruby-identifier">load_inverted</span>
  <span class="ruby-identifier">load_weights</span>
  <span class="ruby-identifier">load_similarity</span>
  <span class="ruby-identifier">load_configuration</span>
  <span class="ruby-identifier">load_realtime</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-load_configuration">
            
              <a name="method-i-load_configuration"></a><b>load_configuration</b>()
            
          </div>
          
          
            <div class="description">
              <p>Loads the configuration.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-load_configuration_source')" id="l_method-i-load_configuration_source">show</a>
                
              </p>
              <div id="method-i-load_configuration_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">load_configuration</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">configuration</span> = <span class="ruby-ivar">@backend_configuration</span>.<span class="ruby-identifier">load</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-load_inverted">
            
              <a name="method-i-load_inverted"></a><b>load_inverted</b>()
            
          </div>
          
          
            <div class="description">
              <p>Loads the core index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-load_inverted_source')" id="l_method-i-load_inverted_source">show</a>
                
              </p>
              <div id="method-i-load_inverted_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 61</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">load_inverted</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">inverted</span> = <span class="ruby-ivar">@backend_inverted</span>.<span class="ruby-identifier">load</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-load_realtime">
            
              <a name="method-i-load_realtime"></a><b>load_realtime</b>()
            
          </div>
          
          
            <div class="description">
              <p>Loads the realtime mapping.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-load_realtime_source')" id="l_method-i-load_realtime_source">show</a>
                
              </p>
              <div id="method-i-load_realtime_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 83</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">load_realtime</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">realtime</span> = <span class="ruby-ivar">@backend_realtime</span>.<span class="ruby-identifier">load</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-load_similarity">
            
              <a name="method-i-load_similarity"></a><b>load_similarity</b>()
            
          </div>
          
          
            <div class="description">
              <p>Loads the similarity index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-load_similarity_source')" id="l_method-i-load_similarity_source">show</a>
                
              </p>
              <div id="method-i-load_similarity_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 73</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">load_similarity</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">similarity</span> = <span class="ruby-ivar">@backend_similarity</span>.<span class="ruby-identifier">load</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@similarity_strategy</span>.<span class="ruby-identifier">saved?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-load_weights">
            
              <a name="method-i-load_weights"></a><b>load_weights</b>()
            
          </div>
          
          
            <div class="description">
              <p>Loads the weights index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-load_weights_source')" id="l_method-i-load_weights_source">show</a>
                
              </p>
              <div id="method-i-load_weights_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 66</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">load_weights</span>
  <span class="ruby-comment"># TODO THINK about this. Perhaps the strategies should implement the backend methods?</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">weights</span> = <span class="ruby-ivar">@backend_weights</span>.<span class="ruby-identifier">load</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@weights_strategy</span>.<span class="ruby-identifier">saved?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-remove">
            
              <a name="method-i-remove"></a><b>remove</b>(id)
            
          </div>
          
          
            <div class="description">
              <p>Removes the given id from the indexes.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-remove_source')" id="l_method-i-remove_source">show</a>
                
              </p>
              <div id="method-i-remove_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_realtime.rb, line 7</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">remove</span> <span class="ruby-identifier">id</span>
  <span class="ruby-comment"># Is it anywhere?</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">syms</span> = <span class="ruby-ivar">@realtime</span>[<span class="ruby-identifier">id</span>]
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">syms</span>

  <span class="ruby-identifier">syms</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sym</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">ids</span> = <span class="ruby-ivar">@inverted</span>[<span class="ruby-identifier">sym</span>]
    <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">id</span>

    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">empty?</span>
      <span class="ruby-ivar">@inverted</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">sym</span>
      <span class="ruby-ivar">@weights</span>.<span class="ruby-identifier">delete</span>  <span class="ruby-identifier">sym</span>
      <span class="ruby-comment"># Since no element uses this sym anymore, we can delete the similarity for it.</span>
      <span class="ruby-comment"># TODO Not really. Since multiple syms can point to the same encoded.</span>
      <span class="ruby-ivar">@similarity</span>.<span class="ruby-identifier">delete</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">similarity_strategy</span>.<span class="ruby-identifier">encoded</span>(<span class="ruby-identifier">sym</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@weights</span>[<span class="ruby-identifier">sym</span>] = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">weights_strategy</span>.<span class="ruby-identifier">weight_for</span> <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">size</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@realtime</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">id</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-reset_backend">
            
              <a name="method-i-reset_backend"></a><b>reset_backend</b>()
            
          </div>
          
          
            <div class="description">
              <p>Initializes all necessary indexes from the backend.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-reset_backend_source')" id="l_method-i-reset_backend_source">show</a>
                
              </p>
              <div id="method-i-reset_backend_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 74</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">reset_backend</span>
  <span class="ruby-comment"># Extract specific indexes from backend.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-ivar">@backend_inverted</span>      = <span class="ruby-identifier">backend</span>.<span class="ruby-identifier">create_inverted</span>      <span class="ruby-keyword">self</span>
  <span class="ruby-ivar">@backend_weights</span>       = <span class="ruby-identifier">backend</span>.<span class="ruby-identifier">create_weights</span>       <span class="ruby-keyword">self</span>
  <span class="ruby-ivar">@backend_similarity</span>    = <span class="ruby-identifier">backend</span>.<span class="ruby-identifier">create_similarity</span>    <span class="ruby-keyword">self</span>
  <span class="ruby-ivar">@backend_configuration</span> = <span class="ruby-identifier">backend</span>.<span class="ruby-identifier">create_configuration</span> <span class="ruby-keyword">self</span>
  <span class="ruby-ivar">@backend_realtime</span>      = <span class="ruby-identifier">backend</span>.<span class="ruby-identifier">create_realtime</span>      <span class="ruby-keyword">self</span>

  <span class="ruby-comment"># Initial indexes.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># Note that if the weights strategy doesn't need to be saved,</span>
  <span class="ruby-comment"># the strategy itself pretends to be an index.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-ivar">@inverted</span>      = <span class="ruby-ivar">@backend_inverted</span>.<span class="ruby-identifier">initial</span>
  <span class="ruby-ivar">@weights</span>       = <span class="ruby-ivar">@weights_strategy</span>.<span class="ruby-identifier">saved?</span><span class="ruby-operator">?</span> <span class="ruby-ivar">@backend_weights</span>.<span class="ruby-identifier">initial</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@weights_strategy</span>
  <span class="ruby-ivar">@similarity</span>    = <span class="ruby-ivar">@backend_similarity</span>.<span class="ruby-identifier">initial</span>
  <span class="ruby-ivar">@configuration</span> = <span class="ruby-ivar">@backend_configuration</span>.<span class="ruby-identifier">initial</span>
  <span class="ruby-ivar">@realtime</span>      = <span class="ruby-ivar">@backend_realtime</span>.<span class="ruby-identifier">initial</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-similar">
            
              <a name="method-i-similar"></a><b>similar</b>(text)
            
          </div>
          
          
            <div class="description">
              <p>Get a list of similar texts.</p>

<p>Note: Does not return itself.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-similar_source')" id="l_method-i-similar_source">show</a>
                
              </p>
              <div id="method-i-similar_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 127</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">similar</span> <span class="ruby-identifier">text</span>
  <span class="ruby-identifier">code</span> = <span class="ruby-identifier">similarity_strategy</span>.<span class="ruby-identifier">encoded</span> <span class="ruby-identifier">text</span>
  <span class="ruby-identifier">similar_codes</span> = <span class="ruby-identifier">code</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@similarity</span>[<span class="ruby-identifier">code</span>]
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">similar_codes</span>
    <span class="ruby-identifier">similar_codes</span> = <span class="ruby-identifier">similar_codes</span>.<span class="ruby-identifier">dup</span> <span class="ruby-comment"># TODO</span>
    <span class="ruby-identifier">similar_codes</span>.<span class="ruby-identifier">delete</span> <span class="ruby-identifier">text</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">similar_codes</span> <span class="ruby-operator">||</span> []
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-to_s">
            
              <a name="method-i-to_s"></a><b>to_s</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-to_s_source')" id="l_method-i-to_s_source">show</a>
                
              </p>
              <div id="method-i-to_s_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle.rb, line 170</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">to_s</span>
  <span class="ruby-node">&quot;#{self.class}(#{identifier})&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-weight">
            
              <a name="method-i-weight"></a><b>weight</b>(sym_or_string)
            
          </div>
          
          
            <div class="description">
              <p>Get a weight for the given symbol.</p>

<p>Returns a number, or nil.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-weight_source')" id="l_method-i-weight_source">show</a>
                
              </p>
              <div id="method-i-weight_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/bundle_indexed.rb, line 34</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">weight</span> <span class="ruby-identifier">sym_or_string</span>
  <span class="ruby-ivar">@weights</span>[<span class="ruby-identifier">sym_or_string</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    