<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Picky::Index</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            Picky::Index 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/picky/index_rb.html">lib/picky/index.rb</a></li>
            
            <li><a href="../../files/lib/picky/index_convenience_rb.html">lib/picky/index_convenience.rb</a></li>
            
            <li><a href="../../files/lib/picky/index_facets_rb.html">lib/picky/index_facets.rb</a></li>
            
            <li><a href="../../files/lib/picky/index_indexed_rb.html">lib/picky/index_indexed.rb</a></li>
            
            <li><a href="../../files/lib/picky/index_indexing_rb.html">lib/picky/index_indexing.rb</a></li>
            
            <li><a href="../../files/lib/picky/index_realtime_rb.html">lib/picky/index_realtime.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="label-Picky+Indexes"><a href="../Picky.html">Picky</a> <a href="Indexes.html">Indexes</a></h1>

<p>A <a href="../Picky.html">Picky</a> <a href="Index.html">Index</a> defines</p>
<ul><li>
<p>what backend it uses.</p>
</li><li>
<p>where its data comes from (a data source).</p>
</li><li>
<p>how this data it is indexed.</p>
</li><li>
<p>a number of categories that may or may not map directly to data categories.</p>
</li></ul>

<h2 id="label-Howto">Howto</h2>

<p>This is a step-by-step description on how to create an index.</p>

<p>Start by choosing an <code>Index</code> or an <code>Index</code>. In the
example, we will be using an in-memory index, <code>Index</code>.</p>

<pre>books = Index.new(:books)</pre>

<p>That in itself won’t do much good, that’s why we add a data source:</p>

<pre>books = Index.new(:books) do
  source Sources::CSV.new(:title, :author, file: 'data/books.csv')
end</pre>

<p>In the example, we use an explicit <code>Sources::CSV</code> of <a
href="../Picky.html">Picky</a>. However, anything that responds to
<code>#each</code>, and returns an object that answers to <code>#id</code>,
works.</p>

<p>For example, a 3.0 ActiveRecord class:</p>

<pre>books = Index.new(:books) do
  source Book.order('isbn ASC')
end</pre>

<p>Now we know where the data comes from, but not, how to categorize it.</p>

<p>Let’s add a few categories:</p>

<pre>books = Index.new(:books) do
  source   Book.order('isbn ASC')
  category :title
  category :author
  category :isbn
end</pre>

<p><a href="Categories.html">Categories</a> offer quite a few options, see
<code>Indexes::Base#category</code> for details.</p>

<p>After adding more options, it might look like this:</p>

<pre>books = Index.new(:books) do
  source   Book.order('isbn ASC')
  category :title,
           partial: Partial::Substring.new(from: 1),
           similarity: Similarity::DoubleMetaphone.new(3),
           qualifiers: [:t, :title, :titulo]
  category :author,
           similarity: Similarity::Metaphone.new(2)
  category :isbn,
           partial: Partial::None.new,
           from: :legacy_isbn_name
end</pre>

<p>For this to work, a <code>Book</code> should support methods
<code>#title</code>, <code>#author</code> and
<code>#legacy_isbn_name</code>.</p>

<p>If it uses <code>String</code> ids, use <code>#key_format</code> to define
a formatting method:</p>

<pre>books = Index.new(:books) do
  key_format :to_s
  source     Book.order('isbn ASC')
  category   :title
  category   :author
  category   :isbn
end</pre>

<p>Finally, use the index for a <code>Search</code>:</p>

<pre class="ruby"><span class="ruby-identifier">route</span> <span class="ruby-regexp">%r{^/media$}</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Search</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">books</span>, <span class="ruby-identifier">dvds</span>, <span class="ruby-identifier">mp3s</span>)
</pre>

<p>This class defines the indexing and index <a href="API.html">API</a> that
is exposed to the user as the <a href="Index.html#method-i-index">index</a>
method inside the Application class.</p>

<p>It provides a single front for both indexing and index options. We suggest
to always use the index <a href="API.html">API</a>.</p>

<p>Note: An <a href="Index.html">Index</a> holds both an
<strong>Indexed</strong>::<strong><a href="Index.html">Index</a></strong>
and an <strong>Indexing</strong>::<strong><a
href="Index.html">Index</a></strong>.</p>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>#</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-3C-3C">&lt;&lt;</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-after_indexing">after_indexing</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-backend">backend</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-category">category</a>,
              </li>
            
              
              <li>
                <a href="#method-i-check_source_empty">check_source_empty</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-facets">facets</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>G</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-geo_categories">geo_categories</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-identifier">identifier</a>,
              </li>
            
              
              <li>
                <a href="#method-i-index">index</a>,
              </li>
            
              
              <li>
                <a href="#method-i-indexing">indexing</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>K</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-key_format">key_format</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>P</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-prepare">prepare</a>,
              </li>
            
              
              <li>
                <a href="#method-i-prepare_in_parallel">prepare_in_parallel</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-ranged_category">ranged_category</a>,
              </li>
            
              
              <li>
                <a href="#method-i-result_identifier">result_identifier</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-source">source</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-to_s">to_s</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_stats">to_stats</a>,
              </li>
            
              
              <li>
                <a href="#method-i-tokenizer">tokenizer</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>U</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-unshift">unshift</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>W</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-with_data_snapshot">with_data_snapshot</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="API/Tokenizer.html">
              Picky::API::Tokenizer
            </a>
          
        </li>
      
        <li>
          
            <a href="API/Source.html">
              Picky::API::Source
            </a>
          
        </li>
      
        <li>
          
            <a href="Helpers/Indexing.html">
              Picky::Helpers::Indexing
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>categories</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>name</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <a name="method-c-new"></a><b>new</b>(name)
            
          </div>
          
          
            <div class="description">
              <p>Create a new index with a given source.</p>

<h3 id="method-c-new-label-Parameters">Parameters</h3>
<ul><li>
<p>name: A name that will be used for the index directory and in the <a
href="../Picky.html">Picky</a> front end.</p>
</li></ul>

<h3 id="method-c-new-label-Options+%28all+are+used+in+the+block+-+not+passed+as+a+Hash%2C+see+examples%29">Options (all are used in the block - not passed as a <a href="../Hash.html">Hash</a>, see examples)</h3>
<ul><li>
<p>source: Where the data comes from, e.g. Sources::CSV.new(…). Optional, can
be defined in the block using <a
href="Index.html#method-i-source">source</a>.</p>
</li><li>
<p><a href="Index.html#method-i-result_identifier">#result_identifier</a>: Use
if you’d like a different identifier/name in the results than the name of
the index.</p>
</li><li>
<p><a href="Index.html#method-i-after_indexing">#after_indexing</a>: As of
this writing only used in the db source. Executes the given <a
href="Index.html#method-i-after_indexing">#after_indexing</a> as SQL after
the indexing process.</p>
</li><li>
<p>indexing: Call and pass either a tokenizer (responds to tokenize) or the
options for a tokenizer..</p>
</li><li>
<p><a href="Index.html#method-i-key_format">#key_format</a>: Call and pass in
a format method for the ids (default is to_i).</p>
</li></ul>

<p>Example:</p>

<pre>my_index = Index.new(:my_index) do
  source            Sources::CSV.new(file: 'data/index.csv')
  key_format        :to_sym
  category          :bla
  result_identifier :my_special_results
end</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index.rb, line 119</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span> <span class="ruby-identifier">name</span>
  <span class="ruby-ivar">@name</span>       = <span class="ruby-identifier">name</span>.<span class="ruby-identifier">intern</span>
  <span class="ruby-ivar">@categories</span> = <span class="ruby-constant">Categories</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-comment"># Centralized registry.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-constant">Indexes</span>.<span class="ruby-identifier">register</span> <span class="ruby-keyword">self</span>

  <span class="ruby-identifier">instance_eval</span>(&amp;<span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-3C-3C">
            
              <a name="method-i-3C-3C"></a><b>&lt;&lt;</b>(thing)
            
          </div>
          
          
            <div class="description">
              <p>Add at the end.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-3C-3C_source')" id="l_method-i-3C-3C_source">show</a>
                
              </p>
              <div id="method-i-3C-3C_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_realtime.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword ruby-title">thing</span>
  <span class="ruby-identifier">add</span> <span class="ruby-identifier">thing</span>, <span class="ruby-identifier">__method__</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-after_indexing">
            
              <a name="method-i-after_indexing"></a><b>after_indexing</b>(after_indexing = nil)
            
          </div>
          
          
            <div class="description">
              <p>Define what to do after indexing. (Only used in the Sources::DB)</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-after_indexing_source')" id="l_method-i-after_indexing_source">show</a>
                
              </p>
              <div id="method-i-after_indexing_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 115</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">after_indexing</span> <span class="ruby-identifier">after_indexing</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">after_indexing</span> <span class="ruby-operator">?</span> (<span class="ruby-ivar">@after_indexing</span> = <span class="ruby-identifier">after_indexing</span>) <span class="ruby-operator">:</span> <span class="ruby-ivar">@after_indexing</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-backend">
            
              <a name="method-i-backend"></a><b>backend</b>(backend = nil)
            
          </div>
          
          
            <div class="description">
              <p><a href="API.html">API</a> method.</p>

<p>Sets/returns the backend used. Default is @Backends::Memory.new@.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-backend_source')" id="l_method-i-backend_source">show</a>
                
              </p>
              <div id="method-i-backend_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index.rb, line 135</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">backend</span> <span class="ruby-identifier">backend</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">backend</span>
    <span class="ruby-ivar">@backend</span> = <span class="ruby-identifier">backend</span>
    <span class="ruby-identifier">reset_backend</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@backend</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Backends</span><span class="ruby-operator">::</span><span class="ruby-constant">Memory</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-category">
            
              <a name="method-i-category"></a><b>category</b>(category_name, options = {})
            
          </div>
          
          
            <div class="description">
              <p><a href="API.html">API</a> method.</p>

<p>Defines a searchable category on the index.</p>

<h3 id="method-i-category-label-Parameters">Parameters</h3>
<ul><li>
<p>category_name: This identifier is used in the front end, but also to
categorize query text. For example, “title:hobbit” will narrow the hobbit
query on categories with the identifier :title.</p>
</li></ul>

<h3 id="method-i-category-label-Options">Options</h3>
<ul><li>
<p>indexing: Pass in either a tokenizer or tokenizer options.</p>
</li><li>
<p>partial: Partial::None.new or Partial::Substring.new(from: starting_char,
to: ending_char). Default is Partial::Substring.new(from: -3, to: -1).</p>
</li><li>
<p>similarity: Similarity::None.new or
Similarity::DoubleMetaphone.new(similar_words_searched). Default is
Similarity::None.new.</p>
</li><li>
<p>qualifiers: An array of qualifiers with which you can define which category
you’d like to search, for example “title:hobbit” will search for hobbit in
just title categories. Example: qualifiers: [:t, :titre, :title] (use it
for example with multiple languages). Default is the name of the category.</p>
</li><li>
<p>qualifier: Convenience options if you just need a single qualifier, see
above. Example: qualifiers =&gt; :title. Default is the name of the
category.</p>
</li><li>
<p>source: Use a different source than the index uses. If you think you need
that, there might be a better solution to your problem. Please post to the
mailing list first with your application.rb :)</p>
</li><li>
<p>from: Take the data from the data category with this name. Example: You
have a source Sources::CSV.new(:title, file:‘some_file.csv’) but you want
the category to be called differently. The you use from:
category(:similar_title, :from =&gt; :title).</p>
</li></ul>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-category_source')" id="l_method-i-category_source">show</a>
                
              </p>
              <div id="method-i-category_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index.rb, line 173</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">category</span> <span class="ruby-identifier">category_name</span>, <span class="ruby-identifier">options</span> = {}
  <span class="ruby-identifier">new_category</span> = <span class="ruby-constant">Category</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">category_name</span>.<span class="ruby-identifier">intern</span>, <span class="ruby-keyword">self</span>, <span class="ruby-identifier">options</span>
  <span class="ruby-identifier">categories</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">new_category</span>

  <span class="ruby-identifier">new_category</span> = <span class="ruby-keyword">yield</span> <span class="ruby-identifier">new_category</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>

  <span class="ruby-identifier">new_category</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-check_source_empty">
            
              <a name="method-i-check_source_empty"></a><b>check_source_empty</b>()
            
          </div>
          
          
            <div class="description">
              <p>Check if the given enumerable source is empty.</p>

<p>Note: Checking as early as possible to tell the</p>

<pre>user as early as possible.</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-check_source_empty_source')" id="l_method-i-check_source_empty_source">show</a>
                
              </p>
              <div id="method-i-check_source_empty_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 60</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">check_source_empty</span>
  <span class="ruby-identifier">warn</span> <span class="ruby-node">%Q{\n\0033[1mWarning\0033[m, source for index &quot;#{name}&quot; is empty: #{source} (responds true to empty?).\n}</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:empty?</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">empty?</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-facets">
            
              <a name="method-i-facets"></a><b>facets</b>(category_identifier, options = {})
            
          </div>
          
          
            <div class="description">
              <p>Return facets for a category in the form:</p>

<pre class="ruby">{ <span class="ruby-identifier">text</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">weight</span> } <span class="ruby-comment"># or ids.size?</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-facets_source')" id="l_method-i-facets_source">show</a>
                
              </p>
              <div id="method-i-facets_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_facets.rb, line 8</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">facets</span> <span class="ruby-identifier">category_identifier</span>, <span class="ruby-identifier">options</span> = {}
  <span class="ruby-identifier">weights</span> = <span class="ruby-keyword">self</span>[<span class="ruby-identifier">category_identifier</span>].<span class="ruby-identifier">exact</span>.<span class="ruby-identifier">weights</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">minimal_weight</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:more_than</span>]
    <span class="ruby-identifier">weights</span>.<span class="ruby-identifier">select</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span> <span class="ruby-identifier">weight</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">minimal_weight</span> }
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">weights</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-geo_categories">
            
              <a name="method-i-geo_categories"></a><b>geo_categories</b>(lat_name, lng_name, radius, options = {})
            
          </div>
          
          
            <div class="description">
              <p>HIGHLY EXPERIMENTAL Not correctly working yet. <a href="Try.html">Try</a>
it if you feel “beta”.</p>

<p>Also a range search see <a
href="Index.html#method-i-ranged_category">ranged_category</a>, but on the
earth’s surface.</p>

<p>Parameters:</p>
<ul><li>
<p>lat_name: The latitude’s name as used in <a
href="Index.html#method-i-category">category</a>.</p>
</li><li>
<p>lng_name: The longitude’s name as used in <a
href="Index.html#method-i-category">category</a>.</p>
</li><li>
<p>radius: The distance (in km) around the query point which we search for
results.</p>
</li></ul>

<p>Note: <a href="../Picky.html">Picky</a> uses a square, not a circle. That
should be ok for most usages.</p>

<pre>-----------------------------
|                           |
|                           |
|                           |
|                           |
|                           |
|             *&lt;-  radius -&gt;|
|                           |
|                           |
|                           |
|                           |
|                           |
-----------------------------</pre>

<p>Options</p>
<ul><li>
<p>precision: Default 1 (20% error margin, very fast), up to 5 (5% error
margin, slower) makes sense.</p>
</li><li>
<p>lat_from: The data category to take the data for the latitude from.</p>
</li><li>
<p>lng_from: The data category to take the data for the longitude from.</p>
</li></ul>

<p>THINK Will have to write a wrapper that combines two categories that are
indexed simultaneously, since lat/lng are correlated.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-geo_categories_source')" id="l_method-i-geo_categories_source">show</a>
                
              </p>
              <div id="method-i-geo_categories_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index.rb, line 292</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">geo_categories</span> <span class="ruby-identifier">lat_name</span>, <span class="ruby-identifier">lng_name</span>, <span class="ruby-identifier">radius</span>, <span class="ruby-identifier">options</span> = {}

  <span class="ruby-comment"># Extract lat/lng specific options.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">lat_from</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span> <span class="ruby-value">:lat_from</span>
  <span class="ruby-identifier">lng_from</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span> <span class="ruby-value">:lng_from</span>

  <span class="ruby-comment"># One can be a normal ranged_category.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">ranged_category</span> <span class="ruby-identifier">lat_name</span>, <span class="ruby-identifier">radius</span>*<span class="ruby-number">0.00898312</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">from</span><span class="ruby-operator">:</span> <span class="ruby-identifier">lat_from</span>)

  <span class="ruby-comment"># The other needs to adapt the radius depending on the one.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># Depending on the latitude, the radius of the longitude</span>
  <span class="ruby-comment"># needs to enlarge, the closer we get to the pole.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># In our simplified case, the radius is given as if all the</span>
  <span class="ruby-comment"># locations were on the 45 degree line.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># This calculates km -&gt; longitude (degrees).</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-comment"># A degree on the 45 degree line is equal to ~222.6398 km.</span>
  <span class="ruby-comment"># So a km on the 45 degree line is equal to 0.01796624 degrees.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">ranged_category</span> <span class="ruby-identifier">lng_name</span>, <span class="ruby-identifier">radius</span>*<span class="ruby-number">0.01796624</span>, <span class="ruby-identifier">options</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">from</span><span class="ruby-operator">:</span> <span class="ruby-identifier">lng_from</span>)

<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-identifier">
            
              <a name="method-i-identifier"></a><b>identifier</b>()
            
          </div>
          
          
            <div class="description">
              <p>Identifier used for technical output.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-identifier_source')" id="l_method-i-identifier_source">show</a>
                
              </p>
              <div id="method-i-identifier_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index.rb, line 332</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">identifier</span>
  <span class="ruby-identifier">name</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-index">
            
              <a name="method-i-index"></a><b>index</b>(scheduler = Scheduler.new)
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-index_source')" id="l_method-i-index_source">show</a>
                
              </p>
              <div id="method-i-index_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 28</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">index</span> <span class="ruby-identifier">scheduler</span> = <span class="ruby-constant">Scheduler</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">timed_indexing</span> <span class="ruby-identifier">scheduler</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">prepare</span> <span class="ruby-identifier">scheduler</span>
    <span class="ruby-identifier">scheduler</span>.<span class="ruby-identifier">finish</span>

    <span class="ruby-identifier">cache</span> <span class="ruby-identifier">scheduler</span>
    <span class="ruby-identifier">scheduler</span>.<span class="ruby-identifier">finish</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-indexing">
            
              <a name="method-i-indexing"></a><b>indexing</b>(options = {})
            
          </div>
          
          
            <div class="description">
              <p>Define an index tokenizer on the index.</p>

<p>Parameters are the exact same as for indexing.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-indexing_source')" id="l_method-i-indexing_source">show</a>
                
              </p>
              <div id="method-i-indexing_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 22</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">indexing</span> <span class="ruby-identifier">options</span> = {}
  <span class="ruby-ivar">@tokenizer</span> = <span class="ruby-identifier">extract_tokenizer</span> <span class="ruby-identifier">options</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-key_format">
            
              <a name="method-i-key_format"></a><b>key_format</b>(key_format = nil)
            
          </div>
          
          
            <div class="description">
              <p>Define a <a href="Index.html#method-i-key_format">#key_format</a> on the
index.</p>

<p>Parameter is a method name to use on the key (e.g. :to_i, :<a
href="Index.html#method-i-to_s">#to_s</a>, :strip).</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-key_format_source')" id="l_method-i-key_format_source">show</a>
                
              </p>
              <div id="method-i-key_format_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 108</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">key_format</span> <span class="ruby-identifier">key_format</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">key_format</span> <span class="ruby-operator">?</span> (<span class="ruby-ivar">@key_format</span> = <span class="ruby-identifier">key_format</span>) <span class="ruby-operator">:</span> <span class="ruby-ivar">@key_format</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-prepare">
            
              <a name="method-i-prepare"></a><b>prepare</b>(scheduler = Scheduler.new)
            
          </div>
          
          
            <div class="description">
              <p>Calling prepare on an index will call prepare on every category.</p>

<p>Decides whether to use a parallel indexer or whether to delegate to each
category to prepare themselves.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-prepare_source')" id="l_method-i-prepare_source">show</a>
                
              </p>
              <div id="method-i-prepare_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 44</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">prepare</span> <span class="ruby-identifier">scheduler</span> = <span class="ruby-constant">Scheduler</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:each</span>)
    <span class="ruby-identifier">check_source_empty</span>
    <span class="ruby-identifier">prepare_in_parallel</span> <span class="ruby-identifier">scheduler</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">with_data_snapshot</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">categories</span>.<span class="ruby-identifier">prepare</span> <span class="ruby-identifier">scheduler</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-prepare_in_parallel">
            
              <a name="method-i-prepare_in_parallel"></a><b>prepare_in_parallel</b>(scheduler)
            
          </div>
          
          
            <div class="description">
              <p><a href="Indexes.html">Indexes</a> the categories in parallel.</p>

<p>Only use where the category does have a each source defined.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-prepare_in_parallel_source')" id="l_method-i-prepare_in_parallel_source">show</a>
                
              </p>
              <div id="method-i-prepare_in_parallel_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 68</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">prepare_in_parallel</span> <span class="ruby-identifier">scheduler</span>
  <span class="ruby-identifier">indexer</span> = <span class="ruby-constant">Indexers</span><span class="ruby-operator">::</span><span class="ruby-constant">Parallel</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">self</span>
  <span class="ruby-identifier">indexer</span>.<span class="ruby-identifier">prepare</span> <span class="ruby-identifier">categories</span>, <span class="ruby-identifier">scheduler</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ranged_category">
            
              <a name="method-i-ranged_category"></a><b>ranged_category</b>(category_name, range, options = {})
            
          </div>
          
          
            <div class="description">
              <p>Make this category range searchable with a fixed range. If you need other
ranges, define another category with a different range value.</p>

<p>Example: You have data values inside 1..100, and you want to have <a
href="../Picky.html">Picky</a> return not only the results for 47 if you
search for 47, but also results for 45, 46, or 47.2, 48.9, in a range of 2
around 47, so (45..49).</p>

<p>Then you use:</p>

<pre>ranged_category :values_inside_1_100, 2</pre>

<p>Optionally, you give it a precision value to reduce the error margin around
47 (<a href="../Picky.html">Picky</a> is a bit liberal).</p>

<pre>Index.new :range do
  ranged_category :values_inside_1_100, 2, precision: 5
end</pre>

<p>This will force <a href="../Picky.html">Picky</a> to maximally be wrong 5%
of the given range value (5% of 2 = 0.1) instead of the default 20% (20% of
2 = 0.4).</p>

<p>We suggest not to use much more than 5 as a higher precision is more
performance intensive for less and less precision gain.</p>

<h2 id="method-i-ranged_category-label-Protip+1">Protip 1</h2>

<p>Create two ranged categories to make an area search:</p>

<pre>Index.new :area do
  ranged_category :x, 1
  ranged_category :y, 1
end</pre>

<p><a href="Search.html">Search</a> for it using for example:</p>

<pre>x:133, y:120</pre>

<p>This will search this square area (* = 133, 120: The “search” point
entered):</p>

<pre> 132       134
  |         |
--|---------|-- 121
  |         |
  |    *    |
  |         |
--|---------|-- 119
  |         |</pre>

<p>Note: The area does not need to be square, but can be rectangular.</p>

<h2 id="method-i-ranged_category-label-Protip+2">Protip 2</h2>

<p>Create three ranged categories to make a volume search.</p>

<p>Or go crazy and use 4 ranged categories for a space/time search! ;)</p>

<h3 id="method-i-ranged_category-label-Parameters">Parameters</h3>
<ul><li>
<p>category_name: The category_name as used in <a
href="Index.html#method-i-category">category</a>.</p>
</li><li>
<p>range: The range (in the units of your data values) around the query point
where we search for results.</p>
</li></ul>

<pre>-----|&lt;- range  -&gt;*------------|-----</pre>

<h3 id="method-i-ranged_category-label-Options">Options</h3>
<ul><li>
<p>precision: Default is 1 (20% error margin, very fast), up to 5 (5% error
margin, slower) makes sense.</p>
</li><li>
<p>anchor: Where to anchor the grid.</p>
</li><li>
<p>… all options of <a href="Index.html#method-i-category">category</a>.</p>
</li></ul>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ranged_category_source')" id="l_method-i-ranged_category_source">show</a>
                
              </p>
              <div id="method-i-ranged_category_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index.rb, line 246</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ranged_category</span> <span class="ruby-identifier">category_name</span>, <span class="ruby-identifier">range</span>, <span class="ruby-identifier">options</span> = {}
  <span class="ruby-identifier">precision</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:precision</span>) <span class="ruby-operator">||</span> <span class="ruby-number">1</span>
  <span class="ruby-identifier">anchor</span>    = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:anchor</span>)    <span class="ruby-operator">||</span> <span class="ruby-number">0.0</span>

  <span class="ruby-comment"># Note: :key_format =&gt; :to_f ?</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">options</span> = { <span class="ruby-identifier">partial</span><span class="ruby-operator">:</span> <span class="ruby-constant">Partial</span><span class="ruby-operator">::</span><span class="ruby-constant">None</span>.<span class="ruby-identifier">new</span> }.<span class="ruby-identifier">merge</span> <span class="ruby-identifier">options</span>

  <span class="ruby-identifier">category</span> <span class="ruby-identifier">category_name</span>, <span class="ruby-identifier">options</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">cat</span><span class="ruby-operator">|</span>
    <span class="ruby-constant">Category</span><span class="ruby-operator">::</span><span class="ruby-constant">Location</span>.<span class="ruby-identifier">install_on</span> <span class="ruby-identifier">cat</span>, <span class="ruby-identifier">range</span>, <span class="ruby-identifier">precision</span>, <span class="ruby-identifier">anchor</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-result_identifier">
            
              <a name="method-i-result_identifier"></a><b>result_identifier</b>(result_identifier = nil)
            
          </div>
          
          
            <div class="description">
              <p>Define how the results of this index are identified. (Shown in the client,
for example)</p>

<p>Default is the name of the index.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-result_identifier_source')" id="l_method-i-result_identifier_source">show</a>
                
              </p>
              <div id="method-i-result_identifier_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexed.rb, line 18</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">result_identifier</span> <span class="ruby-identifier">result_identifier</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">result_identifier</span> <span class="ruby-operator">?</span> (<span class="ruby-ivar">@result_identifier</span> = <span class="ruby-identifier">result_identifier</span>) <span class="ruby-operator">:</span> (<span class="ruby-ivar">@result_identifier</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@name</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-source">
            
              <a name="method-i-source"></a><b>source</b>(some_source = nil, &amp;block)
            
          </div>
          
          
            <div class="description">
              <p>Define a source on the index.</p>

<p>Parameter is a source, either one of the standard sources or anything
responding to each and returning objects that respond to id and the
category names (or the category from option).</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-source_source')" id="l_method-i-source_source">show</a>
                
              </p>
              <div id="method-i-source_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 99</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">source</span> <span class="ruby-identifier">some_source</span> = <span class="ruby-keyword">nil</span>, &amp;<span class="ruby-identifier">block</span>
  <span class="ruby-identifier">some_source</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">block</span>
  <span class="ruby-identifier">some_source</span> <span class="ruby-operator">?</span> (<span class="ruby-ivar">@source</span> = <span class="ruby-identifier">extract_source</span>(<span class="ruby-identifier">some_source</span>)) <span class="ruby-operator">:</span> <span class="ruby-identifier">unblock_source</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-to_s">
            
              <a name="method-i-to_s"></a><b>to_s</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-to_s_source')" id="l_method-i-to_s_source">show</a>
                
              </p>
              <div id="method-i-to_s_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index.rb, line 338</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">to_s</span>
  <span class="ruby-node">&quot;#{self.class}(#{name}, result_id: #{result_identifier}, source: #{@source}, categories: #{categories})&quot;</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-to_stats">
            
              <a name="method-i-to_stats"></a><b>to_stats</b>()
            
          </div>
          
          
            <div class="description">
              
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-to_stats_source')" id="l_method-i-to_stats_source">show</a>
                
              </p>
              <div id="method-i-to_stats_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index.rb, line 320</span>
    <span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">to_stats</span>
      <span class="ruby-identifier">stats</span> = <span class="ruby-string">&quot;#{name} (#{self.class}):
#{&quot;source:            #{source}&quot;.indented_to_s}
#{&quot;categories:        #{categories.map(&amp;:name).join(', ')}&quot;.indented_to_s}
&quot;</span>
      <span class="ruby-identifier">stats</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;  result identifier: \&quot;#{result_identifier}\&quot;&quot;</span>.<span class="ruby-identifier">indented_to_s</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">result_identifier</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">to_s</span>
      <span class="ruby-identifier">stats</span>
    <span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-tokenizer">
            
              <a name="method-i-tokenizer"></a><b>tokenizer</b>()
            
          </div>
          
          
            <div class="description">
              <p>Returns the installed tokenizer or the default.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-tokenizer_source')" id="l_method-i-tokenizer_source">show</a>
                
              </p>
              <div id="method-i-tokenizer_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 89</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">tokenizer</span>
  <span class="ruby-ivar">@tokenizer</span> <span class="ruby-operator">||</span> <span class="ruby-constant">Indexes</span>.<span class="ruby-identifier">tokenizer</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-unshift">
            
              <a name="method-i-unshift"></a><b>unshift</b>(thing)
            
          </div>
          
          
            <div class="description">
              <p>Add at the beginning (calls add).</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-unshift_source')" id="l_method-i-unshift_source">show</a>
                
              </p>
              <div id="method-i-unshift_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_realtime.rb, line 23</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">unshift</span> <span class="ruby-identifier">thing</span>
  <span class="ruby-identifier">add</span> <span class="ruby-identifier">thing</span>, <span class="ruby-identifier">__method__</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-with_data_snapshot">
            
              <a name="method-i-with_data_snapshot"></a><b>with_data_snapshot</b>()
            
          </div>
          
          
            <div class="description">
              <p>Note: Duplicated in category_indexing.rb.</p>

<p>Take a data snapshot if the source offers it.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-with_data_snapshot_source')" id="l_method-i-with_data_snapshot_source">show</a>
                
              </p>
              <div id="method-i-with_data_snapshot_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/index_indexing.rb, line 77</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">with_data_snapshot</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">source</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:with_snapshot</span>
    <span class="ruby-identifier">source</span>.<span class="ruby-identifier">with_snapshot</span>(<span class="ruby-keyword">self</span>) <span class="ruby-keyword">do</span>
      <span class="ruby-keyword">yield</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">yield</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    