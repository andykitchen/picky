<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Picky::Search</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>     
    <div class="banner">
        
        <h1>
            <span class="type">Class</span> 
            Picky::Search 
            
                <span class="parent">&lt; 
                    
                    <a href="../Object.html">Object</a>
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/picky/search_rb.html">lib/picky/search.rb</a></li>
            
            <li><a href="../../files/lib/picky/search_facets_rb.html">lib/picky/search_facets.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<h1 id="label-Picky+Searches"><a href="../Picky.html">Picky</a> Searches</h1>

<p>A <a href="../Picky.html">Picky</a> <a href="Search.html">Search</a> is an
object which:</p>
<ul><li>
<p>holds one or more indexes</p>
</li><li>
<p>offers an interface to query these indexes.</p>
</li></ul>

<p>Example:</p>

<pre>search = Picky::Search.new index1, index2
search.search 'query'</pre>

    </div>
  


  


  
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-boost">boost</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-execute">execute</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-facets">facets</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-ignore_unassigned_tokens">ignore_unassigned_tokens</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>M</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-max_allocations">max_allocations</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>S</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-search">search</a>,
              </li>
            
              
              <li>
                <a href="#method-i-search_with">search_with</a>,
              </li>
            
              
              <li>
                <a href="#method-i-searching">searching</a>,
              </li>
            
              
              <li>
                <a href="#method-i-sorted_allocations">sorted_allocations</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-terminate_early">terminate_early</a>,
              </li>
            
              
              <li>
                <a href="#method-i-to_s">to_s</a>,
              </li>
            
              
              <li>
                <a href="#method-i-tokenized">tokenized</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  
    <!-- Includes -->
    <div class="sectiontitle">Included Modules</div>
    <ul>
      
        <li>
          
            <a href="API/Search/Boost.html">
              Picky::API::Search::Boost
            </a>
          
        </li>
      
        <li>
          
            <a href="Helpers/Measuring.html">
              Picky::Helpers::Measuring
            </a>
          
        </li>
      
    </ul>
  



  

    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>boosts</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>ignore_unassigned</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>indexes</td>
            <td class='attr-desc'></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [RW]
            </td>
            <td class='attr-name'>tokenizer</td>
            <td class='attr-desc'></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <a name="method-c-new"></a><b>new</b>(*indexes)
            
          </div>
          
          
            <div class="description">
              <p>Takes:</p>
<ul><li>
<p>A number of indexes</p>
</li></ul>

<p>It is also possible to define the tokenizer and boosts like so. Example:</p>

<pre class="ruby"><span class="ruby-identifier">search</span> = <span class="ruby-constant">Search</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">index1</span>, <span class="ruby-identifier">index2</span>, <span class="ruby-identifier">index3</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">searching</span> <span class="ruby-identifier">removes_characters</span><span class="ruby-operator">:</span> <span class="ruby-regexp">%r[^a-z]/</span> <span class="ruby-comment"># etc.</span>
  <span class="ruby-identifier">boosts</span> [:<span class="ruby-identifier">author</span>, :<span class="ruby-identifier">title</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">+3</span>,
          [:<span class="ruby-identifier">title</span>, :<span class="ruby-identifier">isbn</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">+1</span>
<span class="ruby-keyword">end</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 40</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span> *<span class="ruby-identifier">indexes</span>
  <span class="ruby-ivar">@indexes</span> = <span class="ruby-constant">Query</span><span class="ruby-operator">::</span><span class="ruby-constant">Indexes</span>.<span class="ruby-identifier">new</span> *<span class="ruby-identifier">indexes</span>

  <span class="ruby-identifier">instance_eval</span>(&amp;<span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>

  <span class="ruby-ivar">@tokenizer</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Tokenizer</span>.<span class="ruby-identifier">searching</span> <span class="ruby-comment"># THINK Not dynamic. Ok?</span>
  <span class="ruby-ivar">@boosts</span>    <span class="ruby-operator">||=</span> <span class="ruby-constant">Query</span><span class="ruby-operator">::</span><span class="ruby-constant">Boosts</span>.<span class="ruby-identifier">new</span>

  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-boost">
            
              <a name="method-i-boost"></a><b>boost</b>(boosts)
            
          </div>
          
          
            <div class="description">
              <p>Examples:</p>

<pre class="ruby"><span class="ruby-identifier">search</span> = <span class="ruby-constant">Search</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">books_index</span>, <span class="ruby-identifier">dvd_index</span>, <span class="ruby-identifier">mp3_index</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">boost</span> [:<span class="ruby-identifier">author</span>, :<span class="ruby-identifier">title</span>] =<span class="ruby-operator">&gt;</span> <span class="ruby-value">+3</span>,
        [:<span class="ruby-identifier">title</span>, :<span class="ruby-identifier">isbn</span>]   =<span class="ruby-operator">&gt;</span> <span class="ruby-value">+1</span>
<span class="ruby-keyword">end</span>
</pre>

<p>or</p>

<pre class="ruby"><span class="ruby-comment"># Explicitly add a random number (0...1) to the boosts.</span>
<span class="ruby-comment">#</span>
<span class="ruby-identifier">my_boosts</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>
  <span class="ruby-comment"># Instance only needs to implement</span>
  <span class="ruby-comment">#   boost_for combinations</span>
  <span class="ruby-comment"># and return a number that is</span>
  <span class="ruby-comment"># added to the score.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-keyword">def</span> <span class="ruby-identifier">boost_for</span> <span class="ruby-identifier">combinations</span>
    <span class="ruby-identifier">rand</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>.<span class="ruby-identifier">new</span>

<span class="ruby-identifier">search</span> = <span class="ruby-constant">Search</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">books_index</span>, <span class="ruby-identifier">dvd_index</span>, <span class="ruby-identifier">mp3_index</span>) <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">boost</span> <span class="ruby-identifier">my_boosts</span>
<span class="ruby-keyword">end</span>
</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-boost_source')" id="l_method-i-boost_source">show</a>
                
              </p>
              <div id="method-i-boost_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 138</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">boost</span> <span class="ruby-identifier">boosts</span>
  <span class="ruby-ivar">@boosts</span> = <span class="ruby-identifier">extract_boosts</span> <span class="ruby-identifier">boosts</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-execute">
            
              <a name="method-i-execute"></a><b>execute</b>(tokens, ids, offset, original_text = nil, unique = false)
            
          </div>
          
          
            <div class="description">
              <p>Execute a search using <a href="Query/Tokens.html">Query::Tokens</a>.</p>

<p>Note: Internal method, use <a href="Search.html#method-i-search">search</a>
to search.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-execute_source')" id="l_method-i-execute_source">show</a>
                
              </p>
              <div id="method-i-execute_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 205</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">execute</span> <span class="ruby-identifier">tokens</span>, <span class="ruby-identifier">ids</span>, <span class="ruby-identifier">offset</span>, <span class="ruby-identifier">original_text</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">unique</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-constant">Results</span>.<span class="ruby-identifier">from</span> <span class="ruby-identifier">original_text</span>,
               <span class="ruby-identifier">ids</span>,
               <span class="ruby-identifier">offset</span>,
               <span class="ruby-identifier">sorted_allocations</span>(<span class="ruby-identifier">tokens</span>, <span class="ruby-ivar">@max_allocations</span>),
               <span class="ruby-ivar">@extra_allocations</span>,
               <span class="ruby-identifier">unique</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-facets">
            
              <a name="method-i-facets"></a><b>facets</b>(category_identifier, options = {})
            
          </div>
          
          
            <div class="description">
              <p>Returns a list of filtered facets.</p>

<p>Params</p>

<pre>category: The category whose facets to return.</pre>

<p>Options</p>

<pre>more_than: A minimum weight a facet needs to have (exclusive). 
filter: A query to filter the facets with.</pre>

<p>Usage:</p>

<pre>search.facets :name, filter: 'surname:peter', more_than: 0</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-facets_source')" id="l_method-i-facets_source">show</a>
                
              </p>
              <div id="method-i-facets_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search_facets.rb, line 17</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">facets</span> <span class="ruby-identifier">category_identifier</span>, <span class="ruby-identifier">options</span> = {}
  <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;#{__method__} cannot be used on searches with more than 1 index yet. Sorry!&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">indexes</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-number">1</span>
  <span class="ruby-identifier">index</span> = <span class="ruby-identifier">indexes</span>.<span class="ruby-identifier">first</span>
  
  <span class="ruby-comment"># Get index-specific facet weights.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">weights</span> = <span class="ruby-identifier">index</span>.<span class="ruby-identifier">facets</span> <span class="ruby-identifier">category_identifier</span>, <span class="ruby-identifier">options</span>
  
  <span class="ruby-comment"># We're done if there is no filter.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">weights</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">filter_query</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:filter</span>]
  
  <span class="ruby-comment"># Pre-tokenize filter for reuse.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">tokenized_filter</span> = <span class="ruby-identifier">tokenized</span> <span class="ruby-identifier">filter_query</span>, <span class="ruby-keyword">false</span>
  
  <span class="ruby-comment"># Filter out impossible facets.</span>
  <span class="ruby-comment">#</span>
  <span class="ruby-identifier">weights</span>.<span class="ruby-identifier">select</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">weight</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">tokenized_query</span> = <span class="ruby-identifier">tokenized</span> <span class="ruby-node">&quot;#{category_identifier}:#{key}&quot;</span>, <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">search_with</span>(<span class="ruby-identifier">tokenized_filter</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">tokenized_query</span>, <span class="ruby-number">0</span>, <span class="ruby-number">0</span>).<span class="ruby-identifier">total</span> <span class="ruby-operator">&gt;</span> <span class="ruby-number">0</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-ignore_unassigned_tokens">
            
              <a name="method-i-ignore_unassigned_tokens"></a><b>ignore_unassigned_tokens</b>(value = true)
            
          </div>
          
          
            <div class="description">
              <p>Ignore the given token if it cannot be matched to a category. The default
behaviour is that if a token does not match to any category, the query will
not return anything (since a single token cannot be matched). If you set
this option to true, any token that cannot be matched to a category will be
simply ignored.</p>

<p>Use this if only a few matched words are important, like for example of the
query “Jonathan Myers 86455 Las Cucarachas” you only want to match the
zipcode, to have the search engine display advertisements on the side for
the zipcode.</p>

<p>False by default.</p>

<p>Example:</p>

<pre>search = Search.new(books_index, dvd_index, mp3_index) do
  ignore_unassigned_tokens
end</pre>

<p>With this set (to true), if in “Peter Flunder”, “Flunder” couldn’t be
assigned to any category, it will simply be ignored. This is done for each
categorization.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-ignore_unassigned_tokens_source')" id="l_method-i-ignore_unassigned_tokens_source">show</a>
                
              </p>
              <div id="method-i-ignore_unassigned_tokens_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 165</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">ignore_unassigned_tokens</span> <span class="ruby-identifier">value</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@ignore_unassigned</span> = <span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-max_allocations">
            
              <a name="method-i-max_allocations"></a><b>max_allocations</b>(amount = nil)
            
          </div>
          
          
            <div class="description">
              <p>Sets the max amount of allocations to calculate.</p>

<p>Examples:</p>

<pre>search = Search.new(index1, index2, index3) do
  max_allocations 10
end</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-max_allocations_source')" id="l_method-i-max_allocations_source">show</a>
                
              </p>
              <div id="method-i-max_allocations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 78</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">max_allocations</span> <span class="ruby-identifier">amount</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">amount</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@max_allocations</span> = <span class="ruby-identifier">amount</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@max_allocations</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-search">
            
              <a name="method-i-search"></a><b>search</b>(text, ids = 20, offset = 0, options = {})
            
          </div>
          
          
            <div class="description">
              <p>This is the main entry point for a query. Use this in specs and also for
running queries.</p>

<p>Parameters:</p>
<ul><li>
<p>text:       The search text.</p>
</li><li>
<p>ids = 20:   The amount of ids to calculate (with offset).</p>
</li><li>
<p>offset = 0: The offset from which position to return the ids. Useful for
pagination.</p>
</li></ul>

<p>Options:</p>
<ul><li>
<p>unique: Whether to return unique ids.</p>
</li></ul>

<p>Note: The <a href="../Rack.html">Rack</a> adapter calls this method after
unravelling the HTTP request.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-search_source')" id="l_method-i-search_source">show</a>
                
              </p>
              <div id="method-i-search_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 182</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">search</span> <span class="ruby-identifier">text</span>, <span class="ruby-identifier">ids</span> = <span class="ruby-number">20</span>, <span class="ruby-identifier">offset</span> = <span class="ruby-number">0</span>, <span class="ruby-identifier">options</span> = {}
  <span class="ruby-identifier">search_with</span> <span class="ruby-identifier">tokenized</span>(<span class="ruby-identifier">text</span>), <span class="ruby-identifier">ids</span>.<span class="ruby-identifier">to_i</span>, <span class="ruby-identifier">offset</span>.<span class="ruby-identifier">to_i</span>, <span class="ruby-identifier">text</span>, <span class="ruby-identifier">options</span>[<span class="ruby-value">:unique</span>]
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-search_with">
            
              <a name="method-i-search_with"></a><b>search_with</b>(tokens, ids = 20, offset = 0, original_text = nil, unique = false)
            
          </div>
          
          
            <div class="description">
              <p>Runs the actual search using <a href="Query/Tokens.html">Query::Tokens</a>.</p>

<p>Note: Internal method, use <a href="Search.html#method-i-search">search</a>
to search.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-search_with_source')" id="l_method-i-search_with_source">show</a>
                
              </p>
              <div id="method-i-search_with_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 190</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">search_with</span> <span class="ruby-identifier">tokens</span>, <span class="ruby-identifier">ids</span> = <span class="ruby-number">20</span>, <span class="ruby-identifier">offset</span> = <span class="ruby-number">0</span>, <span class="ruby-identifier">original_text</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">unique</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">results</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">duration</span> = <span class="ruby-identifier">timed</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">results</span> = <span class="ruby-identifier">execute</span> <span class="ruby-identifier">tokens</span>, <span class="ruby-identifier">ids</span>, <span class="ruby-identifier">offset</span>, <span class="ruby-identifier">original_text</span>, <span class="ruby-identifier">unique</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">results</span>.<span class="ruby-identifier">duration</span> = <span class="ruby-identifier">duration</span>.<span class="ruby-identifier">round</span> <span class="ruby-number">6</span>

  <span class="ruby-identifier">results</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-searching">
            
              <a name="method-i-searching"></a><b>searching</b>(options)
            
          </div>
          
          
            <div class="description">
              <p>Defines tokenizer options or the tokenizer itself.</p>

<p>Examples:</p>

<pre>search = Search.new(index1, index2, index3) do
  searching removes_characters: /[^a-z]/,
            # etc.
end

search = Search.new(index1, index2, index3) do
  searching MyTokenizerThatRespondsToTheMethodTokenize.new
end</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-searching_source')" id="l_method-i-searching_source">show</a>
                
              </p>
              <div id="method-i-searching_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 63</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">searching</span> <span class="ruby-identifier">options</span>
  <span class="ruby-ivar">@tokenizer</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:tokenize</span>)
    <span class="ruby-identifier">options</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">options</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Tokenizer</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-sorted_allocations">
            
              <a name="method-i-sorted_allocations"></a><b>sorted_allocations</b>(tokens, amount = nil)
            
          </div>
          
          
            <div class="description">
              <p>Gets sorted allocations for the tokens.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-sorted_allocations_source')" id="l_method-i-sorted_allocations_source">show</a>
                
              </p>
              <div id="method-i-sorted_allocations_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 235</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">sorted_allocations</span> <span class="ruby-identifier">tokens</span>, <span class="ruby-identifier">amount</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">indexes</span>.<span class="ruby-identifier">prepared_allocations_for</span> <span class="ruby-identifier">tokens</span>, <span class="ruby-identifier">boosts</span>, <span class="ruby-identifier">amount</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-terminate_early">
            
              <a name="method-i-terminate_early"></a><b>terminate_early</b>(extra_allocations = 0)
            
          </div>
          
          
            <div class="description">
              <p>Tells <a href="../Picky.html">Picky</a> to terminate calculating ids if it
has enough ids. (So, early)</p>

<p>Important note: Do not use this for the live search! (As <a
href="../Picky.html">Picky</a> needs to calculate the total)</p>

<p>Note: When using the <a href="../Picky.html">Picky</a> interface, do not
terminate too early as this will kill off the allocation selections. A
value of</p>

<pre>terminate_early 5</pre>

<p>is probably a good idea to show the user 5 extra beyond the needed ones.</p>

<p>Examples:</p>

<pre># Terminate if you have enough ids.
#
search = Search.new(index1, index2, index3) do
  terminate_early
end

# After calculating enough ids,
# calculate 5 extra allocations for the interface.
#
search = Search.new(index1, index2, index3) do
  terminate_early 5
end</pre>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-terminate_early_source')" id="l_method-i-terminate_early_source">show</a>
                
              </p>
              <div id="method-i-terminate_early_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 109</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">terminate_early</span> <span class="ruby-identifier">extra_allocations</span> = <span class="ruby-number">0</span>
  <span class="ruby-ivar">@extra_allocations</span> = <span class="ruby-identifier">extra_allocations</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">extra_allocations</span>[<span class="ruby-value">:with_extra_allocations</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">extra_allocations</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-to_s">
            
              <a name="method-i-to_s"></a><b>to_s</b>()
            
          </div>
          
          
            <div class="description">
              <p>Display some nice information for the user.</p>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-to_s_source')" id="l_method-i-to_s_source">show</a>
                
              </p>
              <div id="method-i-to_s_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 241</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">to_s</span>
  <span class="ruby-identifier">s</span> = <span class="ruby-node">&quot;#{self.class}(&quot;</span>
  <span class="ruby-identifier">ary</span> = []
  <span class="ruby-identifier">ary</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@indexes</span>.<span class="ruby-identifier">indexes</span>.<span class="ruby-identifier">map</span>(&amp;<span class="ruby-value">:name</span>).<span class="ruby-identifier">join</span>(<span class="ruby-string">', '</span>) <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@indexes</span>.<span class="ruby-identifier">indexes</span>.<span class="ruby-identifier">empty?</span>
  <span class="ruby-identifier">ary</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;boosts: #{@boosts}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@boosts</span>
  <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">ary</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">', '</span>)
  <span class="ruby-identifier">s</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;)&quot;</span>
  <span class="ruby-identifier">s</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-tokenized">
            
              <a name="method-i-tokenized"></a><b>tokenized</b>(text, partialize_last = true)
            
          </div>
          
          
            <div class="description">
              <p>Delegates the tokenizing to the query tokenizer.</p>

<p>Parameters:</p>
<ul><li>
<p>text: The string to tokenize.</p>
</li><li>
<p>partialize_last: Whether to partialize the last token</p>
</li></ul>

<p>Note: By default, the last token is always partial.</p>

<p>Returns:</p>
<ul><li>
<p>A <a href="Query/Tokens.html">Picky::Query::Tokens</a> instance.</p>
</li></ul>
            </div>
          
          
          
          
          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source: 
                <a href="javascript:toggleSource('method-i-tokenized_source')" id="l_method-i-tokenized_source">show</a>
                
              </p>
              <div id="method-i-tokenized_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/picky/search.rb, line 225</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">tokenized</span> <span class="ruby-identifier">text</span>, <span class="ruby-identifier">partialize_last</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">tokens</span>, <span class="ruby-identifier">originals</span> = <span class="ruby-identifier">tokenizer</span>.<span class="ruby-identifier">tokenize</span> <span class="ruby-identifier">text</span>
  <span class="ruby-identifier">tokens</span> = <span class="ruby-constant">Query</span><span class="ruby-operator">::</span><span class="ruby-constant">Tokens</span>.<span class="ruby-identifier">processed</span> <span class="ruby-identifier">tokens</span>, <span class="ruby-identifier">originals</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">tokens</span>, <span class="ruby-ivar">@ignore_unassigned</span>
  <span class="ruby-comment"># tokens.symbolize # TODO Symbols.</span>
  <span class="ruby-identifier">tokens</span>.<span class="ruby-identifier">partialize_last</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">partialize_last</span>
  <span class="ruby-identifier">tokens</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    </div>
    </div>
  </body>
</html>    